<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lonchera M√°gica - Selecci√≥n de Men√∫</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'DM Sans', sans-serif; }

    /* Fondo borroso */
    #bg {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-image: url('https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=1600&q=80');
      background-size: cover;
      background-position: center;
      filter: blur(4px);
      z-index: -2;
    }

    .overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(255,255,255,0.65);
      z-index: -1;
    }

    #mobileMenu {
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
      position: fixed;
      top: 4rem;
      left: 0;
      width: 100%;
      background-color: rgba(255,140,0,0.95);
      text-align: center;
      padding: 1.5rem 0;
      border-radius: 0 0 1rem 1rem;
      z-index: 50;
      transition: all 0.3s ease-in-out;
    }
  </style>
</head>
<body class="bg-gradient-to-b from-orange-50 to-yellow-100 text-gray-800">

  <div id="bg"></div>
  <div class="overlay"></div>

  <!-- NAVBAR -->
  <header class="absolute top-0 left-0 w-full z-50">
    <nav class="flex items-center justify-between px-4 md:px-6 py-4 max-w-7xl mx-auto">
      <div class="flex items-center space-x-3">
        <img src="assets/logo.png" alt="Logo" class="h-10 w-10 md:h-12 md:w-12">
        <span class="text-xl md:text-2xl font-bold text-black drop-shadow-md">Lonchera M√°gica</span>
      </div>
      <ul class="hidden md:flex space-x-6 md:space-x-8 text-lg font-medium text-black drop-shadow-md">
        <li><a href="index.html">Inicio</a></li>
        <li><a href="menus.html">Men√∫s</a></li>
        <li><a href="blog.html">Blog</a></li>
        <li><a href="seleccion.html" class="text-orange-600">Selecci√≥n</a></li>
        <li><a href="contacto.html">Contacto</a></li>
      </ul>
      <div class="md:hidden text-3xl cursor-pointer text-black" id="menuToggle">‚ò∞</div>
    </nav>
    <div id="mobileMenu" class="hidden md:hidden flex-col items-center bg-orange-500/95 text-white py-6 fixed top-16 left-0 w-full z-50 rounded-b-xl">
      <a href="index.html" class="block py-2 px-4 hover:bg-orange-600 w-full text-center">Inicio</a>
      <a href="menus.html" class="block py-2 px-4 hover:bg-orange-600 w-full text-center">Men√∫s</a>
      <a href="blog.html" class="block py-2 px-4 hover:bg-orange-600 w-full text-center">Blog</a>
      <a href="seleccion.html" class="block py-2 px-4 hover:bg-orange-600 w-full text-center">Selecci√≥n</a>
      <a href="contacto.html" class="block py-2 px-4 hover:bg-orange-600 w-full text-center">Contacto</a>
    </div>
  </header>

  <!-- FORMULARIO -->
  <section class="pt-28 px-6 max-w-4xl mx-auto">
    <h2 class="text-4xl font-extrabold text-orange-700 mb-10 text-center">Elige tu Men√∫ Semanal</h2>

    <form id="menuForm" class="bg-white p-8 rounded-xl shadow-lg space-y-6">
      <div>
        <label class="block text-lg font-medium mb-2">Nombre del ni√±o</label>
        <input type="text" id="nombre" class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-orange-500" required>
      </div>
      <div>
        <label class="block text-lg font-medium mb-2">Edad</label>
        <input type="number" id="edad" class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-orange-500" required>
      </div>

      <!-- NUEVO: Estado nutricional -->
      <div>
        <label class="block text-lg font-medium mb-2">Estado nutricional</label>
        <select id="estado" class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-orange-500" required>
          <option value="normal">Peso normal</option>
          <option value="desnutricion">Desnutrici√≥n</option>
          <option value="sobrepeso">Sobrepeso</option>
        </select>
      </div>

      <!-- Men√∫ base -->
      <div class="bg-orange-100 p-4 rounded-lg shadow-md">
        <h3 class="font-bold text-orange-700 mb-2">Men√∫ Base del Colegio üçé</h3>
        <ul id="menuBase" class="list-disc list-inside text-gray-700"></ul>
      </div>

      <!-- Men√∫s por d√≠a -->
      <p class="text-lg font-medium text-gray-700 mt-4">Puedes personalizar si lo deseas:</p>
      <div id="menuPersonalizado" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>

      <button type="submit" class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded-lg shadow-md transition w-full">
        Confirmar Selecci√≥n
      </button>
    </form>

    <!-- HISTORIAL -->
    <div id="historial" class="mt-10 hidden">
      <h3 class="text-2xl font-bold text-orange-700 mb-4">Historial de Selecci√≥n</h3>
      <div id="historialLista" class="space-y-4"></div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="mt-16 bg-orange-100 py-10">
    <div class="max-w-6xl mx-auto text-center px-4">
      <p class="text-lg md:text-xl text-orange-700 font-semibold">
        "Come para vivir, no vivas para comer. La alimentaci√≥n saludable es el camino hacia una vida plena y feliz."
      </p>
    </div>
  </footer>

  <script>
    const menuToggle = document.getElementById('menuToggle');
    const mobileMenu = document.getElementById('mobileMenu');
    menuToggle.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));

    // Datos de men√∫s seg√∫n estado nutricional
    const menus = {
      normal: [
        "S√°ndwich integral, ensalada de frutas y jugo natural",
        "Yogurt con granola y frutas frescas",
        "Fresas con crema (versi√≥n saludable)",
        "Pancakes de avena con fruta fresca y miel",
        "Tacos de pollo desmechado, verdura salteada y limonada"
      ],
      desnutricion: [
        "Arepa con huevo y aguacate + jugo de mango natural",
        "Batido de banano con avena y man√≠",
        "Arroz con pollo y verduras + compota de frutas",
        "Pan integral con queso + leche chocolatada natural",
        "Pasta con at√∫n y ensalada de frutas"
      ],
      sobrepeso: [
        "Wrap de pollo con lechuga + agua saborizada natural",
        "Ensalada de frutas con yogurt light",
        "Tostadas integrales con aguacate y huevo cocido",
        "Avena con manzana verde y canela sin az√∫car",
        "Rollitos de jam√≥n de pavo y pepino + t√© verde fr√≠o"
      ]
    };

    const menuForm = document.getElementById('menuForm');
    const menuBase = document.getElementById('menuBase');
    const menuPersonalizado = document.getElementById('menuPersonalizado');
    const estadoSelect = document.getElementById('estado');
    const historialDiv = document.getElementById('historial');
    const historialLista = document.getElementById('historialLista');

    let historial = JSON.parse(localStorage.getItem("historialMenus")) || [];

    function renderMenu(estado) {
      const opciones = menus[estado];
      menuBase.innerHTML = opciones.map((op, i) => `<li><strong>${["Lunes","Martes","Mi√©rcoles","Jueves","Viernes"][i]}:</strong> ${op}</li>`).join('');
      menuPersonalizado.innerHTML = opciones.map((op, i) => `
        <div>
          <label class="block font-medium mb-2">${["Lunes","Martes","Mi√©rcoles","Jueves","Viernes"][i]}</label>
          <select id="${["lunes","martes","miercoles","jueves","viernes"][i]}" class="w-full border rounded-lg p-3">
            ${opciones.map(o => `<option ${o === op ? "selected" : ""}>${o}</option>`).join('')}
          </select>
        </div>
      `).join('');
    }

    estadoSelect.addEventListener('change', e => renderMenu(e.target.value));
    renderMenu("normal");

    menuForm.addEventListener('submit', e => {
      e.preventDefault();
      const nombre = document.getElementById('nombre').value;
      const edad = document.getElementById('edad').value;
      const estado = estadoSelect.value;

      const dias = ["lunes","martes","miercoles","jueves","viernes"];
      let seleccion = {};
      dias.forEach(dia => seleccion[dia] = document.getElementById(dia).value);

      const registro = { nombre, edad, estado, seleccion };
      historial.push(registro);
      localStorage.setItem("historialMenus", JSON.stringify(historial));
      renderHistorial();
      menuForm.reset();
      renderMenu("normal");
    });

    function renderHistorial() {
      historialLista.innerHTML = "";
      if (historial.length === 0) {
        historialDiv.classList.add("hidden");
        return;
      }
      historialDiv.classList.remove("hidden");
      historial.forEach((item, index) => {
        let seleccionHTML = Object.entries(item.seleccion)
          .map(([dia, comida]) => `<li><strong>${dia.charAt(0).toUpperCase()+dia.slice(1)}:</strong> ${comida}</li>`).join('');

        const div = document.createElement('div');
        div.className = "bg-white p-4 rounded-lg shadow border-l-4 border-orange-500 flex justify-between items-start";
        div.innerHTML = `
          <div>
            <p class="font-semibold">üë¶ ${item.nombre} (${item.edad} a√±os) - <span class="text-orange-600">${item.estado}</span></p>
            <ul class="list-disc list-inside text-gray-700 mt-2">${seleccionHTML}</ul>
          </div>
          <button class="ml-4 bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-md text-sm deleteBtn">Eliminar</button>
        `;
        div.querySelector(".deleteBtn").addEventListener("click", () => {
          historial.splice(index, 1);
          localStorage.setItem("historialMenus", JSON.stringify(historial));
          renderHistorial();
        });
        historialLista.appendChild(div);
      });
    }

    renderHistorial();
  </script>
</body>
</html>
